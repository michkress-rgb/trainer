<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Die Bergwerke zu Falun - Literarische Analyse</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .progress-section {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .badge {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            transition: all 0.3s ease;
            border: 3px solid #ccc;
        }

        .badge.earned {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-color: #f5576c;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
        }

        .badge-label {
            font-size: 0.3em;
            margin-top: 5px;
        }

        .content {
            padding: 30px;
        }

        .stage {
            display: none;
        }

        .stage.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stage h2 {
            color: #1e3c72;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .stage h3 {
            color: #2a5298;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .question-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .drag-drop-area {
            display: flex;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .drag-items {
            flex: 1;
            min-width: 250px;
        }

        .drag-item {
            background: white;
            border: 2px solid #667eea;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: move;
            transition: all 0.3s ease;
        }

        .drag-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .drag-item.dragging {
            opacity: 0.5;
        }

        .drop-zones {
            flex: 1;
            min-width: 250px;
        }

        .drop-zone {
            background: #fff;
            border: 3px dashed #ccc;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            min-height: 60px;
            transition: all 0.3s ease;
        }

        .drop-zone.drag-over {
            background: #e3f2fd;
            border-color: #667eea;
        }

        .drop-zone.correct {
            background: #d4edda;
            border-color: #28a745;
            border-style: solid;
        }

        .drop-zone.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            border-style: solid;
        }

        .drop-zone-label {
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .choice-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .choice-card {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .choice-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .choice-card.selected {
            border-color: #667eea;
            background: #e3f2fd;
        }

        .choice-card.correct {
            border-color: #28a745;
            background: #d4edda;
        }

        .choice-card.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .text-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            margin: 10px 0;
            resize: vertical;
            min-height: 100px;
        }

        .text-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .button-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .feedback {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .feedback.success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }

        .feedback.error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            color: #721c24;
        }

        .feedback.info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }

        .symbol-card {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .symbol-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .symbol-header {
            font-size: 1.3em;
            color: #1e3c72;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .analysis-box {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 3px solid #667eea;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .world-card {
            background: white;
            border: 3px solid #e0e0e0;
            padding: 25px;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .world-card.selected {
            border-color: #667eea;
            background: #e3f2fd;
            transform: scale(1.05);
        }

        .world-title {
            font-size: 1.5em;
            color: #1e3c72;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f0f;
            position: fixed;
            top: -10px;
            z-index: 9999;
            animation: confetti-fall 3s ease-out forwards;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .hint-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .quote-box {
            background: #e8eaf6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-style: italic;
            border-left: 4px solid #3f51b5;
        }

        .final-reflection {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .checklist {
            list-style: none;
            padding: 0;
        }

        .checklist li {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checklist li:hover {
            background: #f8f9fa;
        }

        .checklist li.checked {
            background: #d4edda;
            text-decoration: line-through;
        }

        .checklist li:before {
            content: '‚òê ';
            font-size: 1.2em;
            margin-right: 10px;
        }

        .checklist li.checked:before {
            content: '‚òë ';
            color: #28a745;
        }

        @media (max-width: 768px) {
            .drag-drop-area {
                flex-direction: column;
            }
            
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            .badge {
                width: 60px;
                height: 60px;
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèîÔ∏è Die Bergwerke zu Falun üíé</h1>
            <p>Eine literarische Reise durch E.T.A. Hoffmanns Novelle</p>
        </div>

        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
            <div class="badges">
                <div class="badge" id="badge1" title="Textverst√§ndnis">
                    üìñ
                    <div class="badge-label">Text</div>
                </div>
                <div class="badge" id="badge2" title="Charakteranalyse">
                    üë§
                    <div class="badge-label">Charakter</div>
                </div>
                <div class="badge" id="badge3" title="Symbolik">
                    üîÆ
                    <div class="badge-label">Symbol</div>
                </div>
                <div class="badge" id="badge4" title="Themenanalyse">
                    üí°
                    <div class="badge-label">Thema</div>
                </div>
                <div class="badge" id="badge5" title="Dualit√§t">
                    ‚öñÔ∏è
                    <div class="badge-label">Dualit√§t</div>
                </div>
                <div class="badge" id="badge6" title="Meisteranalyse">
                    üéì
                    <div class="badge-label">Meister</div>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- STUFE 1: Textverst√§ndnis -->
            <div class="stage active" id="stage1">
                <h2>Stufe 1: Grundlegendes Textverst√§ndnis üìñ</h2>
                
                <div class="question-box">
                    <p><strong>Beginnen wir mit der Handlung der Novelle.</strong> Ordne die wichtigsten Ereignisse in die richtige Reihenfolge. Ziehe die Karten in die richtigen Felder!</p>
                </div>

                <div class="drag-drop-area">
                    <div class="drag-items">
                        <h3>Ereignisse (ziehen)</h3>
                        <div class="drag-item" draggable="true" data-answer="3">
                            Elis begegnet dem alten Bergmann Torbern
                        </div>
                        <div class="drag-item" draggable="true" data-answer="1">
                            Elis verliert seine Mutter und wird Seemann
                        </div>
                        <div class="drag-item" draggable="true" data-answer="5">
                            Elis verschwindet im Bergwerk am Hochzeitstag
                        </div>
                        <div class="drag-item" draggable="true" data-answer="2">
                            Elis kehrt nach Hause zur√ºck und f√ºhlt sich leer
                        </div>
                        <div class="drag-item" draggable="true" data-answer="4">
                            Elis verliebt sich in Ulla und wird Bergmann
                        </div>
                        <div class="drag-item" draggable="true" data-answer="6">
                            Elis' perfekt erhaltener Leichnam wird 50 Jahre sp√§ter gefunden
                        </div>
                    </div>

                    <div class="drop-zones">
                        <h3>Chronologische Reihenfolge</h3>
                        <div class="drop-zone" data-position="1">
                            <div class="drop-zone-label">1. Zuerst</div>
                        </div>
                        <div class="drop-zone" data-position="2">
                            <div class="drop-zone-label">2. Dann</div>
                        </div>
                        <div class="drop-zone" data-position="3">
                            <div class="drop-zone-label">3. Danach</div>
                        </div>
                        <div class="drop-zone" data-position="4">
                            <div class="drop-zone-label">4. Sp√§ter</div>
                        </div>
                        <div class="drop-zone" data-position="5">
                            <div class="drop-zone-label">5. Schlie√ülich</div>
                        </div>
                        <div class="drop-zone" data-position="6">
                            <div class="drop-zone-label">6. Am Ende</div>
                        </div>
                    </div>
                </div>

                <div class="feedback" id="stage1Feedback"></div>

                <button class="button" onclick="checkStage1()" id="stage1Check">√úberpr√ºfen</button>
                <button class="button button-secondary" onclick="nextStage(2)" id="stage1Next" style="display:none;">Weiter zu Stufe 2 ‚Üí</button>
            </div>

            <!-- STUFE 2: Charakteranalyse -->
            <div class="stage" id="stage2">
                <h2>Stufe 2: Charakteranalyse - Elis Fr√∂bom üë§</h2>
                
                <div class="question-box">
                    <p><strong>Wer ist Elis wirklich?</strong> Analysieren wir seine Charakterentwicklung durch die Novelle.</p>
                </div>

                <h3>Teil A: Elis' Motivationen</h3>
                <p>Was treibt Elis an? W√§hle die zutreffendsten Aussagen aus:</p>

                <div class="choice-grid" id="motivationChoices">
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        Sehnsucht nach einer tieferen, absoluten Erfahrung
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, false)">
                        Wunsch nach Reichtum und materiellem Erfolg
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        Suche nach Identit√§t und Zugeh√∂rigkeit
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, false)">
                        Abenteuerlust und Reiselust
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        Faszination f√ºr das Mystische und Unbekannte
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        Konflikt zwischen zwei Lebenswelten
                    </div>
                </div>

                <h3>Teil B: Charakterwandel</h3>
                <div class="drag-drop-area">
                    <div class="drag-items">
                        <h3>Eigenschaften</h3>
                        <div class="drag-item" draggable="true" data-answer="before">
                            Orientierungslos, ohne klare Richtung
                        </div>
                        <div class="drag-item" draggable="true" data-answer="after">
                            Besessen von der Bergwelt
                        </div>
                        <div class="drag-item" draggable="true" data-answer="before">
                            Melancholisch nach dem Tod der Mutter
                        </div>
                        <div class="drag-item" draggable="true" data-answer="after">
                            Zerrissen zwischen Liebe und Berufung
                        </div>
                        <div class="drag-item" draggable="true" data-answer="before">
                            F√ºhlt sich im Seemannsleben fremd
                        </div>
                        <div class="drag-item" draggable="true" data-answer="after">
                            Sieht die Oberfl√§chenwelt als leer und bedeutungslos
                        </div>
                    </div>

                    <div class="drop-zones">
                        <div class="drop-zone" data-position="before">
                            <div class="drop-zone-label">üåä Elis VOR dem Bergwerk</div>
                        </div>
                        <div class="drop-zone" data-position="after">
                            <div class="drop-zone-label">‚õèÔ∏è Elis NACH dem Bergwerk</div>
                        </div>
                    </div>
                </div>

                <h3>Teil C: Kritisches Denken</h3>
                <div class="question-box">
                    <p><strong>Reflexionsfrage:</strong> Ist Elis ein tragischer Held oder ein Opfer? Erkl√§re deine Meinung in 3-4 S√§tzen.</p>
                    <textarea class="text-input" id="elisReflection" placeholder="Schreibe hier deine Analyse..."></textarea>
                </div>

                <div class="feedback" id="stage2Feedback"></div>

                <button class="button" onclick="checkStage2()">√úberpr√ºfen</button>
                <button class="button button-secondary" onclick="nextStage(3)" id="stage2Next" style="display:none;">Weiter zu Stufe 3 ‚Üí</button>
            </div>

            <!-- STUFE 3: Symbolik & Leitmotive -->
            <div class="stage" id="stage3">
                <h2>Stufe 3: Symbolik & Leitmotive üîÆ</h2>
                
                <div class="question-box">
                    <p><strong>Hoffmann arbeitet mit wiederkehrenden Symbolen und Motiven.</strong> Lass uns diese entschl√ºsseln!</p>
                </div>

                <h3>Die zentralen Symbole</h3>

                <div class="symbol-card">
                    <div class="symbol-header">‚õèÔ∏è Das Bergwerk</div>
                    <p>Was symbolisiert das Bergwerk? W√§hle alle zutreffenden Deutungen:</p>
                    <div class="choice-grid" id="bergwerkSymbols">
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Das Unterbewusste / die Tiefe der Seele
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, false)">
                            Wirtschaftlicher Fortschritt
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Tod und Verg√§nglichkeit
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Absolute Kunst / h√∂here Wahrheit
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, false)">
                            M√§nnliche St√§rke
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Gefahr und Verlockung zugleich
                        </div>
                    </div>
                </div>

                <div class="symbol-card">
                    <div class="symbol-header">üíé Die Edelsteine & Metalle</div>
                    <p>Ordne die Bedeutungen zu:</p>
                    <div class="drag-drop-area">
                        <div class="drag-items">
                            <div class="drag-item" draggable="true" data-answer="beauty">
                                Sch√∂nheit in der Tiefe / verborgene Pracht
                            </div>
                            <div class="drag-item" draggable="true" data-answer="art">
                                Die vollkommene Kunst, die nur in der Tiefe existiert
                            </div>
                            <div class="drag-item" draggable="true" data-answer="danger">
                                Verlockung, die zur Selbstaufgabe f√ºhrt
                            </div>
                        </div>
                        <div class="drop-zones">
                            <div class="drop-zone" data-position="beauty">
                                <div class="drop-zone-label">‚ú® Sch√∂nheit</div>
                            </div>
                            <div class="drop-zone" data-position="art">
                                <div class="drop-zone-label">üé® Kunst</div>
                            </div>
                            <div class="drop-zone" data-position="danger">
                                <div class="drop-zone-label">‚ö†Ô∏è Gefahr</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="symbol-card">
                    <div class="symbol-header">üåÖ Das Sonnenlicht / Die Oberfl√§che</div>
                    <p>Was repr√§sentiert die Welt √ºber der Erde?</p>
                    <div class="choice-grid" id="surfaceSymbols">
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Das normale, h√§usliche Leben
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Liebe und menschliche Beziehungen
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, false)">
                            Oberfl√§chlichkeit ohne Wert
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Sicherheit und Normalit√§t
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Eine Welt, die Elis zunehmend fremd wird
                        </div>
                    </div>
                </div>

                <h3>Leitmotiv: Die Bergk√∂nigin</h3>
                <div class="quote-box">
                    "Die K√∂nigin... war von unbeschreiblicher Sch√∂nheit... Elis glaubte in einer Verz√ºckung, wie er sie nie gekannt, zu schweben..."
                </div>
                <div class="question-box">
                    <p><strong>Was symbolisiert die Bergk√∂nigin?</strong> Erkl√§re ihre Bedeutung in 2-3 S√§tzen.</p>
                    <textarea class="text-input" id="queenReflection" placeholder="Deine Interpretation..."></textarea>
                </div>

                <div class="feedback" id="stage3Feedback"></div>

                <button class="button" onclick="checkStage3()">√úberpr√ºfen</button>
                <button class="button button-secondary" onclick="nextStage(4)" id="stage3Next" style="display:none;">Weiter zu Stufe 4 ‚Üí</button>
            </div>

            <!-- STUFE 4: Themen -->
            <div class="stage" id="stage4">
                <h2>Stufe 4: Die gro√üen Themen üí°</h2>
                
                <div class="question-box">
                    <p><strong>Welche universellen Themen behandelt Hoffmann in dieser Novelle?</strong> Lass uns tiefer graben!</p>
                </div>

                <h3>Hauptthemen identifizieren</h3>
                <div class="choice-grid" id="themeChoices">
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        <strong>K√ºnstlerexistenz vs. b√ºrgerliches Leben</strong><br>
                        <small>Der Konflikt zwischen absoluter Kunst und normalem Leben</small>
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, false)">
                        <strong>Umweltverschmutzung</strong><br>
                        <small>Kritik am Bergbau</small>
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        <strong>Romantik vs. Aufkl√§rung</strong><br>
                        <small>Das Irrationale gegen das Rationale</small>
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        <strong>Identit√§t und Selbstfindung</strong><br>
                        <small>Wer bin ich? Wo geh√∂re ich hin?</small>
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, false)">
                        <strong>Soziale Ungerechtigkeit</strong><br>
                        <small>Klassenkampf im 19. Jahrhundert</small>
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        <strong>Das Unheimliche / Das Doppelte</strong><br>
                        <small>Die dunkle Seite der Realit√§t</small>
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        <strong>Liebe vs. Berufung</strong><br>
                        <small>Der Konflikt zwischen Herz und Bestimmung</small>
                    </div>
                    <div class="choice-card" onclick="toggleChoice(this, true)">
                        <strong>Zeit und Ewigkeit</strong><br>
                        <small>Verg√§nglichkeit vs. zeitlose Konservierung</small>
                    </div>
                </div>

                <h3>Themenanalyse: Finde Textbelege!</h3>
                <div class="analysis-box">
                    <p><strong>Thema: Die zwei Welten / Die Zerrissenheit</strong></p>
                    <p>Welche Textstellen belegen dieses zentrale Thema? Ordne die Zitate den richtigen Kategorien zu:</p>
                </div>

                <div class="drag-drop-area">
                    <div class="drag-items">
                        <div class="drag-item" draggable="true" data-answer="bergwelt">
                            "Herrlicher als je erschien ihm die wunderbare Pracht der unterirdischen Kristallwelt"
                        </div>
                        <div class="drag-item" draggable="true" data-answer="oberflaeche">
                            "Ulla, die holde Braut, in vollem Festschmuck"
                        </div>
                        <div class="drag-item" draggable="true" data-answer="konflikt">
                            "Aber der alte Torbern stand vor ihm und sprach: 'Was willst du dort oben?'"
                        </div>
                        <div class="drag-item" draggable="true" data-answer="bergwelt">
                            "In der Tiefe leuchtet das ewige Feuer"
                        </div>
                        <div class="drag-item" draggable="true" data-answer="oberflaeche">
                            "Das h√§usliche Gl√ºck mit der geliebten Braut"
                        </div>
                        <div class="drag-item" draggable="true" data-answer="konflikt">
                            "Er f√ºhlte sich hin- und hergerissen zwischen zwei Welten"
                        </div>
                    </div>

                    <div class="drop-zones">
                        <div class="drop-zone" data-position="bergwelt">
                            <div class="drop-zone-label">‚õèÔ∏è Die Bergwelt (das Absolute)</div>
                        </div>
                        <div class="drop-zone" data-position="oberflaeche">
                            <div class="drop-zone-label">üåÖ Die Oberfl√§che (das H√§usliche)</div>
                        </div>
                        <div class="drop-zone" data-position="konflikt">
                            <div class="drop-zone-label">‚ö° Der innere Konflikt</div>
                        </div>
                    </div>
                </div>

                <div class="feedback" id="stage4Feedback"></div>

                <button class="button" onclick="checkStage4()">√úberpr√ºfen</button>
                <button class="button button-secondary" onclick="nextStage(5)" id="stage4Next" style="display:none;">Weiter zu Stufe 5 ‚Üí</button>
            </div>

            <!-- STUFE 5: Dualit√§t - Die Kernfrage -->
            <div class="stage" id="stage5">
                <h2>Stufe 5: Die zentrale Dualit√§t ‚öñÔ∏è</h2>
                
                <div class="question-box">
                    <p><strong>Jetzt kommen wir zum Kern der Novelle:</strong> Hoffmann stellt uns vor eine existenzielle Wahl zwischen zwei Welten. Lass uns diese Dualit√§t genau analysieren!</p>
                </div>

                <h3>Die zwei Welten im Vergleich</h3>
                <div class="two-column">
                    <div class="world-card">
                        <div class="world-title">‚õèÔ∏è Die Bergwelt</div>
                        <h4>Charakteristika:</h4>
                        <ul>
                            <li>Absolute Sch√∂nheit und Perfektion</li>
                            <li>Isolation von der Menschenwelt</li>
                            <li>Mystik und √ºbersinnliche Erfahrung</li>
                            <li>Gefahr und Tod</li>
                            <li>Zeitlosigkeit (Elis' K√∂rper bleibt erhalten)</li>
                            <li>K√ºnstlerische/spirituelle Erf√ºllung</li>
                        </ul>
                        <h4>Repr√§sentiert:</h4>
                        <p>Das absolute Streben nach Kunst, Vollkommenheit, und transzendenter Erfahrung ‚Äì aber um den Preis des Lebens selbst</p>
                    </div>

                    <div class="world-card">
                        <div class="world-title">üåÖ Die Oberfl√§chenwelt (Ulla)</div>
                        <h4>Charakteristika:</h4>
                        <ul>
                            <li>Liebe und menschliche Beziehungen</li>
                            <li>H√§usliches Gl√ºck und Familie</li>
                            <li>Normalit√§t und Alltag</li>
                            <li>Sicherheit und Lebendigkeit</li>
                            <li>Verg√§nglichkeit (Ulla altert)</li>
                            <li>Soziale Integration</li>
                        </ul>
                        <h4>Repr√§sentiert:</h4>
                        <p>Das normale, warme menschliche Leben mit all seinen Freuden ‚Äì aber vielleicht ohne die absolute Erf√ºllung</p>
                    </div>
                </div>

                <h3>Kritische Analyse: Die Ambivalenz</h3>
                <div class="question-box">
                    <p><strong>Wichtig:</strong> Keine der beiden Welten ist einfach "gut" oder "schlecht". Ordne die folgenden Beobachtungen zu:</p>
                </div>

                <div class="drag-drop-area">
                    <div class="drag-items">
                        <div class="drag-item" draggable="true" data-answer="bergwelt-positiv">
                            Elis findet dort eine Intensit√§t, die er nirgendwo sonst erlebt
                        </div>
                        <div class="drag-item" draggable="true" data-answer="bergwelt-negativ">
                            Die Bergwelt fordert sein Leben und isoliert ihn v√∂llig
                        </div>
                        <div class="drag-item" draggable="true" data-answer="ulla-positiv">
                            Ulla bietet echte Liebe und ein erf√ºlltes Leben
                        </div>
                        <div class="drag-item" draggable="true" data-answer="ulla-negativ">
                            Die Oberfl√§chenwelt erscheint Elis zunehmend leer und bedeutungslos
                        </div>
                        <div class="drag-item" draggable="true" data-answer="bergwelt-positiv">
                            Konservierung in ewiger Sch√∂nheit (zeitlos)
                        </div>
                        <div class="drag-item" draggable="true" data-answer="ulla-negativ">
                            Ulla wird alt ‚Äì das Leben ist verg√§nglich
                        </div>
                    </div>

                    <div class="drop-zones">
                        <div class="drop-zone" data-position="bergwelt-positiv">
                            <div class="drop-zone-label">‚õèÔ∏è + Bergwelt (Vorteil)</div>
                        </div>
                        <div class="drop-zone" data-position="bergwelt-negativ">
                            <div class="drop-zone-label">‚õèÔ∏è - Bergwelt (Nachteil)</div>
                        </div>
                        <div class="drop-zone" data-position="ulla-positiv">
                            <div class="drop-zone-label">üåÖ + Ulla-Welt (Vorteil)</div>
                        </div>
                        <div class="drop-zone" data-position="ulla-negativ">
                            <div class="drop-zone-label">üåÖ - Ulla-Welt (Nachteil)</div>
                        </div>
                    </div>
                </div>

                <h3>Die zentrale Frage</h3>
                <div class="analysis-box">
                    <p><strong>Was will Hoffmann uns sagen?</strong> W√§hle die √ºberzeugendsten Interpretationen:</p>
                    <div class="choice-grid" id="interpretationChoices">
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Der K√ºnstler/Romantiker kann nicht in der b√ºrgerlichen Welt leben
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, false)">
                            Bergbau ist gef√§hrlich und sollte verboten werden
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Das Streben nach dem Absoluten f√ºhrt zur Selbstzerst√∂rung
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Es gibt keine einfache L√∂sung ‚Äì beide Welten haben ihren Preis
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, false)">
                            Man sollte immer das Praktische dem Idealistischen vorziehen
                        </div>
                        <div class="choice-card" onclick="toggleChoice(this, true)">
                            Die menschliche Existenz ist fundamental zerrissen
                        </div>
                    </div>
                </div>

                <div class="feedback" id="stage5Feedback"></div>

                <button class="button" onclick="checkStage5()">√úberpr√ºfen</button>
                <button class="button button-secondary" onclick="nextStage(6)" id="stage5Next" style="display:none;">Weiter zur finalen Reflexion ‚Üí</button>
            </div>

            <!-- STUFE 6: Finale Synthese -->
            <div class="stage" id="stage6">
                <h2>Stufe 6: Deine Interpretation üéì</h2>
                
                <div class="final-reflection">
                    <h3 style="color: white; margin-bottom: 20px;">üèÜ Du hast alle Analyseebenen gemeistert!</h3>
                    <p style="font-size: 1.1em;">Jetzt ist es Zeit f√ºr deine eigene, fundierte Interpretation der Novelle.</p>
                </div>

                <div class="question-box">
                    <h3>Die ultimative Frage:</h3>
                    <p><strong>Welche Welt w√ºrdest DU w√§hlen und warum?</strong></p>
                    <p>Schreibe eine durchdachte Reflexion (mindestens 150 W√∂rter), die folgende Punkte einbezieht:</p>
                    <ul class="checklist" id="essayChecklist">
                        <li onclick="toggleChecklistItem(this)">Deine pers√∂nliche Wahl: Bergwelt oder Ulla-Welt?</li>
                        <li onclick="toggleChecklistItem(this)">Bezug auf mindestens 2 Symbole aus der Novelle</li>
                        <li onclick="toggleChecklistItem(this)">Analyse von Elis' Entscheidung</li>
                        <li onclick="toggleChecklistItem(this)">Ein Zitat oder konkreter Textbezug</li>
                        <li onclick="toggleChecklistItem(this)">Reflexion √ºber die Relevanz f√ºr heute</li>
                        <li onclick="toggleChecklistItem(this)">Klare These mit Begr√ºndung</li>
                    </ul>
                </div>

                <textarea class="text-input" id="finalEssay" placeholder="Schreibe deine ausf√ºhrliche Interpretation hier..." style="min-height: 300px;"></textarea>

                <div class="hint-box">
                    <strong>üí° IGCSE-Tipp:</strong> Eine gute literarische Analyse zeigt:
                    <ul>
                        <li>‚úì Textverst√§ndnis auf mehreren Ebenen</li>
                        <li>‚úì Pers√∂nliche Reflexion mit Begr√ºndung</li>
                        <li>‚úì Bezug zu literarischen Techniken (Symbolik, Motive)</li>
                        <li>‚úì Kritisches Denken √ºber Themen und Bedeutung</li>
                        <li>‚úì Klare, strukturierte Argumentation</li>
                    </ul>
                </div>

                <h3>Bonus-Reflexion: Die moderne Relevanz</h3>
                <div class="question-box">
                    <p><strong>Ist Elis' Dilemma heute noch relevant?</strong> Gibt es moderne "Bergwerke" und "Ullas"?</p>
                    <textarea class="text-input" id="modernRelevance" placeholder="Denke an: Karriere vs. Familie, Kunst vs. Kommerz, Ideale vs. Realit√§t..." style="min-height: 120px;"></textarea>
                </div>

                <div class="feedback" id="stage6Feedback"></div>

                <button class="button" onclick="completeCourse()" id="finalSubmit">Abschlie√üen üéì</button>
            </div>

            <!-- Erfolgsnachricht -->
            <div class="stage" id="completion">
                <div class="final-reflection">
                    <h2 style="color: white; text-align: center; font-size: 2.5em; margin-bottom: 20px;">
                        üéâ Herzlichen Gl√ºckwunsch! üéâ
                    </h2>
                    <p style="text-align: center; font-size: 1.3em;">
                        Du hast eine tiefgehende literarische Analyse von "Die Bergwerke zu Falun" abgeschlossen!
                    </p>
                </div>

                <div class="analysis-box" style="margin: 30px 0;">
                    <h3>Was du gelernt hast:</h3>
                    <ul style="line-height: 1.8;">
                        <li>üìñ <strong>Textverst√§ndnis:</strong> Handlung und Struktur analysieren</li>
                        <li>üë§ <strong>Charakteranalyse:</strong> Motivationen und Entwicklung verstehen</li>
                        <li>üîÆ <strong>Symbolik:</strong> Tiefere Bedeutungen entschl√ºsseln</li>
                        <li>üí° <strong>Themenanalyse:</strong> Universelle Fragen erkennen</li>
                        <li>‚öñÔ∏è <strong>Dualit√§t:</strong> Komplexe Gegens√§tze durchdenken</li>
                        <li>üéì <strong>Kritische Interpretation:</strong> Eigene fundierte Meinung bilden</li>
                    </ul>
                </div>

                <div class="question-box">
                    <h3>F√ºr die IGCSE-Pr√ºfung bist du jetzt vorbereitet auf:</h3>
                    <ul style="line-height: 1.8;">
                        <li>‚úì Close reading und Textanalyse</li>
                        <li>‚úì Charakterisierungen mit Textbelegen</li>
                        <li>‚úì Symbolische und thematische Interpretation</li>
                        <li>‚úì Strukturierte Essays mit klarer Argumentation</li>
                        <li>‚úì Pers√∂nliche Reflexion mit literarischem Bezug</li>
                        <li>‚úì Vergleichende Analyse von Textaspekten</li>
                    </ul>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <p style="font-size: 1.2em; color: #1e3c72;">
                        <strong>Deine Reise durch die literarische Tiefe ist abgeschlossen.</strong><br>
                        Genau wie Elis hast du die Schichten durchdrungen ‚Äì nur du bist sicher zur√ºckgekehrt! üèîÔ∏è‚ú®
                    </p>
                </div>

                <button class="button" onclick="location.reload()">Nochmal durchgehen üîÑ</button>
            </div>
        </div>
    </div>

    <script>
        let currentStage = 1;
        let badges = [false, false, false, false, false, false];
        let stage1Complete = false;
        let stage2Motivations = [];
        let stage2CharacterComplete = false;
        let stage3Complete = false;

        // Drag and Drop Funktionalit√§t
        document.addEventListener('DOMContentLoaded', function() {
            setupDragAndDrop();
        });

        function setupDragAndDrop() {
            const dragItems = document.querySelectorAll('.drag-item');
            const dropZones = document.querySelectorAll('.drop-zone');

            dragItems.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
            });

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', handleDragOver);
                zone.addEventListener('drop', handleDrop);
                zone.addEventListener('dragleave', handleDragLeave);
            });
        }

        let draggedElement = null;

        function handleDragStart(e) {
            draggedElement = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            this.classList.add('drag-over');
            return false;
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            this.classList.remove('drag-over');
            
            if (draggedElement) {
                // Entferne vorhandene Items aus dieser Zone
                const existingItems = this.querySelectorAll('.drag-item');
                existingItems.forEach(item => {
                    document.querySelector('.drag-items').appendChild(item);
                });
                
                // F√ºge neues Item hinzu
                this.appendChild(draggedElement);
            }
            
            return false;
        }

        // Stufe 1: Textverst√§ndnis
        function checkStage1() {
            const dropZones = document.querySelectorAll('#stage1 .drop-zone');
            let correct = 0;
            let total = 6;

            dropZones.forEach(zone => {
                const item = zone.querySelector('.drag-item');
                const position = zone.dataset.position;
                
                if (item) {
                    if (item.dataset.answer === position) {
                        zone.classList.add('correct');
                        zone.classList.remove('incorrect');
                        correct++;
                    } else {
                        zone.classList.add('incorrect');
                        zone.classList.remove('correct');
                    }
                }
            });

            const feedback = document.getElementById('stage1Feedback');
            feedback.classList.add('show');

            if (correct === total) {
                feedback.className = 'feedback show success';
                feedback.innerHTML = '<strong>üéâ Ausgezeichnet!</strong> Du hast die Handlung perfekt verstanden. Das ist die Grundlage f√ºr die tiefere Analyse!';
                earnBadge(1);
                document.getElementById('stage1Next').style.display = 'inline-block';
                document.getElementById('stage1Check').style.display = 'none';
                stage1Complete = true;
                celebrateWithConfetti();
            } else {
                feedback.className = 'feedback show error';
                feedback.innerHTML = `<strong>Nicht ganz richtig.</strong> Du hast ${correct} von ${total} Ereignissen richtig zugeordnet. √úberlege nochmal: Was passiert wirklich zuerst? Versuche es erneut!`;
            }

            updateProgress();
        }

        // Stufe 2: Charakteranalyse
        function toggleChoice(element, isCorrect) {
            element.classList.toggle('selected');
            
            // Speichere Auswahl f√ºr sp√§tere √úberpr√ºfung
            if (!element.dataset.correct) {
                element.dataset.correct = isCorrect;
            }
        }

        function checkStage2() {
            // Teil A: Motivationen
            const motivationCards = document.querySelectorAll('#motivationChoices .choice-card');
            let motivationCorrect = 0;
            let motivationTotal = 0;

            motivationCards.forEach(card => {
                const isCorrect = card.dataset.correct === 'true';
                const isSelected = card.classList.contains('selected');
                
                if (isCorrect) {
                    motivationTotal++;
                    if (isSelected) {
                        card.classList.add('correct');
                        motivationCorrect++;
                    }
                } else if (isSelected) {
                    card.classList.add('incorrect');
                }
            });

            // Teil B: Charakterwandel
            const dropZones = document.querySelectorAll('#stage2 .drop-zone');
            let characterCorrect = 0;
            let characterTotal = 6;

            dropZones.forEach(zone => {
                const item = zone.querySelector('.drag-item');
                const position = zone.dataset.position;
                
                if (item) {
                    if (item.dataset.answer === position) {
                        zone.classList.add('correct');
                        characterCorrect++;
                    } else {
                        zone.classList.add('incorrect');
                    }
                }
            });

            // Teil C: Reflexion
            const reflection = document.getElementById('elisReflection').value;
            const hasReflection = reflection.trim().length > 50;

            const feedback = document.getElementById('stage2Feedback');
            feedback.classList.add('show');

            if (motivationCorrect >= 3 && characterCorrect >= 4 && hasReflection) {
                feedback.className = 'feedback show success';
                feedback.innerHTML = '<strong>üëè Hervorragend!</strong> Du verstehst Elis\' Charakter in der Tiefe. Deine Analyse zeigt echtes literarisches Verst√§ndnis!';
                earnBadge(2);
                document.getElementById('stage2Next').style.display = 'inline-block';
                celebrateWithConfetti();
            } else {
                feedback.className = 'feedback show info';
                let hints = [];
                if (motivationCorrect < 3) hints.push('Denke an Elis\' innere Leere und seine Suche nach Bedeutung.');
                if (characterCorrect < 4) hints.push('Wie √§ndert sich Elis nach der ersten Begegnung mit dem Bergwerk?');
                if (!hasReflection) hints.push('Schreibe mindestens 3-4 S√§tze f√ºr deine Reflexion.');
                
                feedback.innerHTML = '<strong>Fast geschafft!</strong> ' + hints.join(' ');
            }

            updateProgress();
        }

        // Stufe 3: Symbolik
        function checkStage3() {
            // Bergwerk Symbole
            const bergwerkCards = document.querySelectorAll('#bergwerkSymbols .choice-card');
            let bergwerkCorrect = 0;
            bergwerkCards.forEach(card => {
                const isCorrect = card.dataset.correct === 'true';
                const isSelected = card.classList.contains('selected');
                if (isCorrect && isSelected) {
                    card.classList.add('correct');
                    bergwerkCorrect++;
                } else if (!isCorrect && isSelected) {
                    card.classList.add('incorrect');
                }
            });

            // Edelsteine Drag-Drop
            const edelsteinZones = document.querySelectorAll('#stage3 .symbol-card:nth-of-type(2) .drop-zone');
            let edelsteinCorrect = 0;
            edelsteinZones.forEach(zone => {
                const item = zone.querySelector('.drag-item');
                if (item && item.dataset.answer === zone.dataset.position) {
                    zone.classList.add('correct');
                    edelsteinCorrect++;
                } else if (item) {
                    zone.classList.add('incorrect');
                }
            });

            // Oberfl√§chenwelt
            const surfaceCards = document.querySelectorAll('#surfaceSymbols .choice-card');
            let surfaceCorrect = 0;
            surfaceCards.forEach(card => {
                const isCorrect = card.dataset.correct === 'true';
                const isSelected = card.classList.contains('selected');
                if (isCorrect && isSelected) {
                    card.classList.add('correct');
                    surfaceCorrect++;
                } else if (!isCorrect && isSelected) {
                    card.classList.add('incorrect');
                }
            });

            // Bergk√∂nigin Reflexion
            const queenReflection = document.getElementById('queenReflection').value;
            const hasQueenReflection = queenReflection.trim().length > 40;

            const feedback = document.getElementById('stage3Feedback');
            feedback.classList.add('show');

            if (bergwerkCorrect >= 3 && edelsteinCorrect >= 2 && surfaceCorrect >= 3 && hasQueenReflection) {
                feedback.className = 'feedback show success';
                feedback.innerHTML = '<strong>üîÆ Brilliant!</strong> Du erkennst die vielschichtige Symbolik in Hoffmanns Werk. Die Bergk√∂nigin ist der Schl√ºssel zum Verst√§ndnis!';
                earnBadge(3);
                document.getElementById('stage3Next').style.display = 'inline-block';
                celebrateWithConfetti();
            } else {
                feedback.className = 'feedback show info';
                feedback.innerHTML = '<strong>Gut begonnen!</strong> Denke daran: Symbole in der Romantik haben oft mehrere Bedeutungsebenen. Die Bergk√∂nigin vereint Tod, Kunst und absolute Sch√∂nheit.';
            }

            updateProgress();
        }

        // Stufe 4: Themen
        function checkStage4() {
            // Hauptthemen
            const themeCards = document.querySelectorAll('#themeChoices .choice-card');
            let themeCorrect = 0;
            themeCards.forEach(card => {
                const isCorrect = card.dataset.correct === 'true';
                const isSelected = card.classList.contains('selected');
                if (isCorrect && isSelected) {
                    card.classList.add('correct');
                    themeCorrect++;
                } else if (!isCorrect && isSelected) {
                    card.classList.add('incorrect');
                }
            });

            // Textbelege
            const themeZones = document.querySelectorAll('#stage4 .drop-zone');
            let textCorrect = 0;
            themeZones.forEach(zone => {
                const item = zone.querySelector('.drag-item');
                if (item && item.dataset.answer === zone.dataset.position) {
                    zone.classList.add('correct');
                    textCorrect++;
                } else if (item) {
                    zone.classList.add('incorrect');
                }
            });

            const feedback = document.getElementById('stage4Feedback');
            feedback.classList.add('show');

            if (themeCorrect >= 4 && textCorrect >= 4) {
                feedback.className = 'feedback show success';
                feedback.innerHTML = '<strong>üí° Exzellent!</strong> Du erkennst die universellen Themen und kannst sie mit konkreten Textstellen belegen. Das ist IGCSE-Niveau!';
                earnBadge(4);
                document.getElementById('stage4Next').style.display = 'inline-block';
                celebrateWithConfetti();
            } else {
                feedback.className = 'feedback show info';
                feedback.innerHTML = '<strong>Weiter so!</strong> Achte darauf, wie Hoffmann die innere Zerrissenheit durch Kontraste in der Sprache ausdr√ºckt.';
            }

            updateProgress();
        }

        // Stufe 5: Dualit√§t
        function checkStage5() {
            // Ambivalenz Drag-Drop
            const dualityZones = document.querySelectorAll('#stage5 .drop-zone');
            let dualityCorrect = 0;
            dualityZones.forEach(zone => {
                const item = zone.querySelector('.drag-item');
                if (item && item.dataset.answer === zone.dataset.position) {
                    zone.classList.add('correct');
                    dualityCorrect++;
                } else if (item) {
                    zone.classList.add('incorrect');
                }
            });

            // Interpretation
            const interpCards = document.querySelectorAll('#interpretationChoices .choice-card');
            let interpCorrect = 0;
            interpCards.forEach(card => {
                const isCorrect = card.dataset.correct === 'true';
                const isSelected = card.classList.contains('selected');
                if (isCorrect && isSelected) {
                    card.classList.add('correct');
                    interpCorrect++;
                } else if (!isCorrect && isSelected) {
                    card.classList.add('incorrect');
                }
            });

            const feedback = document.getElementById('stage5Feedback');
            feedback.classList.add('show');

            if (dualityCorrect >= 4 && interpCorrect >= 3) {
                feedback.className = 'feedback show success';
                feedback.innerHTML = '<strong>‚öñÔ∏è Meisterhaft!</strong> Du verstehst die zentrale Dualit√§t und die Ambivalenz in Hoffmanns Werk. Keine einfachen Antworten ‚Äì genau wie im Leben!';
                earnBadge(5);
                document.getElementById('stage5Next').style.display = 'inline-block';
                celebrateWithConfetti();
            } else {
                feedback.className = 'feedback show info';
                feedback.innerHTML = '<strong>Denke tiefer!</strong> Hoffmann zeigt keine klare "richtige" Wahl. Beide Welten haben Sch√∂nheit und Schrecken.';
            }

            updateProgress();
        }

        // Finale Stufe
        function completeCourse() {
            const finalEssay = document.getElementById('finalEssay').value;
            const modernRelevance = document.getElementById('modernRelevance').value;

            if (finalEssay.trim().length < 150) {
                alert('Bitte schreibe mindestens 150 W√∂rter f√ºr deine Hauptinterpretation.');
                return;
            }

            if (modernRelevance.trim().length < 50) {
                alert('Bitte reflektiere auch √ºber die moderne Relevanz (mindestens 50 W√∂rter).');
                return;
            }

            earnBadge(6);
            celebrateWithConfetti();
            setTimeout(() => {
                nextStage('completion');
            }, 1000);
        }

        // Navigation
        function nextStage(stageNum) {
            document.querySelectorAll('.stage').forEach(stage => {
                stage.classList.remove('active');
            });
            
            const nextStageId = typeof stageNum === 'number' ? `stage${stageNum}` : stageNum;
            document.getElementById(nextStageId).classList.add('active');
            
            if (typeof stageNum === 'number') {
                currentStage = stageNum;
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
            setupDragAndDrop(); // Neu initialisieren f√ºr neue Stage
        }

        // Badge System
        function earnBadge(badgeNum) {
            if (!badges[badgeNum - 1]) {
                badges[badgeNum - 1] = true;
                const badge = document.getElementById(`badge${badgeNum}`);
                badge.classList.add('earned');
                setTimeout(() => {
                    badge.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        badge.style.transform = 'scale(1.1)';
                    }, 200);
                }, 100);
            }
        }

        // Progress Bar
        function updateProgress() {
            const earnedBadges = badges.filter(b => b).length;
            const progress = (earnedBadges / 6) * 100;
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = progress + '%';
            progressFill.textContent = Math.round(progress) + '%';
        }

        // Konfetti
        function celebrateWithConfetti() {
            const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe'];
            const confettiCount = 50;

            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(confetti);

                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 30);
            }
        }

        // Checklist Toggle
        function toggleChecklistItem(item) {
            item.classList.toggle('checked');
        }
    </script>
</body>
</html>