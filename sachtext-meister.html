<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sachtext-Meister üìö</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            min-height: 600px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
            padding: 10px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .grade-selector {
            text-align: center;
            padding: 40px;
        }

        .grade-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .grade-btn {
            padding: 30px 50px;
            font-size: 1.5em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            font-weight: bold;
        }

        .grade-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .menu-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            color: white;
            text-align: center;
        }

        .menu-card:nth-child(2) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .menu-card:nth-child(3) {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .menu-card:nth-child(4) {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .menu-card:nth-child(5) {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .menu-card h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .menu-card p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .exercise-area {
            padding: 20px;
        }

        .question-box {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 5px solid #667eea;
        }

        .question-text {
            font-size: 1.2em;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option-btn {
            padding: 20px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-size: 1em;
        }

        .option-btn:hover {
            border-color: #667eea;
            background: #f8f9fa;
            transform: translateX(5px);
        }

        .option-btn.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .option-btn.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .option-btn.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .draggable {
            padding: 15px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            cursor: move;
            margin: 10px 0;
            user-select: none;
            transition: all 0.3s;
        }

        .draggable:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }

        .draggable.dragging {
            opacity: 0.5;
        }

        .drop-zone {
            min-height: 60px;
            padding: 15px;
            background: #f8f9fa;
            border: 2px dashed #667eea;
            border-radius: 10px;
            margin: 15px 0;
            transition: all 0.3s;
        }

        .drop-zone.drag-over {
            background: #e3e7ff;
            border-color: #4facfe;
        }

        .drop-zone-label {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .feedback {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
        }

        .feedback.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }

        .feedback.error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .feedback.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 2px solid #17a2b8;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .hidden {
            display: none !important;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .tag-sentence {
            padding: 15px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tag-sentence:hover {
            border-color: #667eea;
        }

        .tag-sentence.tagged-fact {
            background: #d4edda;
            border-color: #28a745;
        }

        .tag-sentence.tagged-opinion {
            background: #fff3cd;
            border-color: #ffc107;
        }

        .tag-sentence.tagged-irrelevant {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .tag-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .tag-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .tag-btn.fact {
            background: #28a745;
            color: white;
        }

        .tag-btn.opinion {
            background: #ffc107;
            color: #333;
        }

        .tag-btn.irrelevant {
            background: #dc3545;
            color: white;
        }

        .completion-screen {
            text-align: center;
            padding: 40px;
        }

        .completion-screen h2 {
            color: #28a745;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .completion-screen .score {
            font-size: 3em;
            color: #667eea;
            margin: 20px 0;
        }

        .star-rating {
            font-size: 3em;
            margin: 20px 0;
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 15px 0;
        }

        .word-chip {
            padding: 10px 15px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .word-chip:hover {
            background: #667eea;
            color: white;
        }

        .word-chip.used {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .text-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            margin: 10px 0;
            resize: vertical;
            min-height: 150px;
        }

        .text-input:focus {
            outline: none;
            border-color: #667eea;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 0.5s ease;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            background: #667eea;
            color: white;
            border-radius: 15px;
            font-size: 0.8em;
            margin-left: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .grade-btn {
                padding: 20px 30px;
                font-size: 1.2em;
            }
            
            .menu {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcomeScreen">
            <div class="header">
                <h1>üìö Sachtext-Meister</h1>
                <p style="font-size: 1.2em; color: #666;">Werde zum Experten f√ºr Sachtexte!</p>
            </div>
            
            <div class="grade-selector">
                <h2 style="color: #667eea; margin-bottom: 20px;">W√§hle deine Klassenstufe:</h2>
                <div class="grade-buttons">
                    <button class="grade-btn" onclick="selectGrade(6)">
                        Klasse 6<br>
                        <small style="font-size: 0.6em;">Einstieg</small>
                    </button>
                    <button class="grade-btn" onclick="selectGrade(7)">
                        Klasse 7<br>
                        <small style="font-size: 0.6em;">Fortgeschritten</small>
                    </button>
                    <button class="grade-btn" onclick="selectGrade(8)">
                        Klasse 8<br>
                        <small style="font-size: 0.6em;">Profi</small>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Menu -->
        <div id="mainMenu" class="hidden">
            <div class="header">
                <h1>üìö Sachtext-Meister</h1>
            </div>
            
            <div class="stats-bar">
                <div class="stat">
                    <div class="stat-label">Klasse</div>
                    <div class="stat-value" id="currentGrade">-</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Punkte</div>
                    <div class="stat-value" id="totalPoints">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">√úbungen</div>
                    <div class="stat-value" id="exercisesCompleted">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Erfolgsquote</div>
                    <div class="stat-value" id="successRate">-</div>
                </div>
            </div>

            <div class="menu">
                <div class="menu-card" onclick="startExercise('faktenj√§ger')">
                    <h3>üéØ Faktenj√§ger</h3>
                    <p>Erkenne Fakten, Meinungen und irrelevante Informationen</p>
                </div>
                <div class="menu-card" onclick="startExercise('satzChirurgie')">
                    <h3>üîß Satz-Chirurgie</h3>
                    <p>W√§hle die besten Folges√§tze f√ºr koh√§rente Texte</p>
                </div>
                <div class="menu-card" onclick="startExercise('sachtextStudio')">
                    <h3>üé® Sachtext-Studio</h3>
                    <p>Baue einen Sachtext aus verschiedenen Bausteinen</p>
                </div>
                <div class="menu-card" onclick="startExercise('bausteinGenerator')">
                    <h3>üìù Baustein-Generator</h3>
                    <p>Verwandle Notizen in vollst√§ndige Abs√§tze</p>
                </div>
                <div class="menu-card" onclick="startExercise('konnektorenTraining')">
                    <h3>üîó Konnektoren-Training</h3>
                    <p>Verbinde S√§tze mit passenden Bindew√∂rtern</p>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="resetProgress()">Klasse wechseln</button>
            </div>
        </div>

        <!-- Exercise Area -->
        <div id="exerciseArea" class="hidden">
            <div class="header">
                <h2 id="exerciseTitle">√úbung</h2>
                <button class="btn btn-secondary" onclick="backToMenu()" style="float: right;">‚Üê Zur√ºck zum Men√º</button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%">0%</div>
            </div>

            <div id="exerciseContent"></div>
        </div>
    </div>

    <script>
        // Global State
        let currentGrade = 0;
        let totalPoints = 0;
        let exercisesCompleted = 0;
        let correctAnswers = 0;
        let totalAnswers = 0;
        let currentExercise = null;
        let currentQuestion = 0;
        let currentExerciseData = [];

        // Initialize
        function selectGrade(grade) {
            currentGrade = grade;
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
            updateStats();
            loadProgress();
        }

        function updateStats() {
            document.getElementById('currentGrade').textContent = currentGrade;
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('exercisesCompleted').textContent = exercisesCompleted;
            const rate = totalAnswers > 0 ? Math.round((correctAnswers / totalAnswers) * 100) : 0;
            document.getElementById('successRate').textContent = rate + '%';
        }

        function saveProgress() {
            const progress = {
                grade: currentGrade,
                points: totalPoints,
                completed: exercisesCompleted,
                correct: correctAnswers,
                total: totalAnswers
            };
            localStorage.setItem('sachtextMeisterProgress', JSON.stringify(progress));
        }

        function loadProgress() {
            const saved = localStorage.getItem('sachtextMeisterProgress');
            if (saved) {
                const progress = JSON.parse(saved);
                if (progress.grade === currentGrade) {
                    totalPoints = progress.points || 0;
                    exercisesCompleted = progress.completed || 0;
                    correctAnswers = progress.correct || 0;
                    totalAnswers = progress.total || 0;
                    updateStats();
                }
            }
        }

        function resetProgress() {
            if (confirm('M√∂chtest du wirklich deinen Fortschritt zur√ºcksetzen?')) {
                localStorage.removeItem('sachtextMeisterProgress');
                location.reload();
            }
        }

        function backToMenu() {
            document.getElementById('exerciseArea').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
        }

        function addPoints(points) {
            totalPoints += points;
            updateStats();
            saveProgress();
        }

        // Exercise Data
        const faktenj√§gerData = {
            6: [
                {
                    sentences: [
                        { text: "Katzen sind die besten Haustiere.", type: "opinion" },
                        { text: "Katzen geh√∂ren zur Familie der Felidae.", type: "fact" },
                        { text: "Eine Katze hat vier Beine und einen Schwanz.", type: "fact" },
                        { text: "Ich finde Katzen niedlich.", type: "opinion" },
                        { text: "Katzen k√∂nnen bis zu 16 Jahre alt werden.", type: "fact" }
                    ],
                    topic: "Katzen"
                },
                {
                    sentences: [
                        { text: "Deutschland liegt in Mitteleuropa.", type: "fact" },
                        { text: "Berlin ist die Hauptstadt von Deutschland.", type: "fact" },
                        { text: "Deutschland ist das sch√∂nste Land.", type: "opinion" },
                        { text: "In Deutschland leben etwa 83 Millionen Menschen.", type: "fact" },
                        { text: "Jeder sollte Deutschland besuchen.", type: "opinion" }
                    ],
                    topic: "Deutschland"
                },
                {
                    sentences: [
                        { text: "Wasser besteht aus Wasserstoff und Sauerstoff.", type: "fact" },
                        { text: "Wasser ist durchsichtig und geruchlos.", type: "fact" },
                        { text: "Kaltes Wasser schmeckt am besten.", type: "opinion" },
                        { text: "Wasser gefriert bei 0 Grad Celsius.", type: "fact" },
                        { text: "Bananen sind gelb.", type: "irrelevant" }
                    ],
                    topic: "Wasser"
                }
            ],
            7: [
                {
                    sentences: [
                        { text: "Der Regenwald produziert 20% des weltweiten Sauerstoffs.", type: "fact" },
                        { text: "Regenw√§lder sind wichtig f√ºr unser Klima.", type: "opinion" },
                        { text: "Im Amazonas-Regenwald leben √ºber 10% aller Tierarten.", type: "fact" },
                        { text: "Jeder Mensch sollte Regenw√§lder sch√ºtzen.", type: "opinion" },
                        { text: "Fu√üball ist ein beliebter Sport.", type: "irrelevant" },
                        { text: "Laut WWF werden t√§glich 150 Arten ausgerottet.", type: "fact" }
                    ],
                    topic: "Regenwald"
                },
                {
                    sentences: [
                        { text: "Die Erde dreht sich in 24 Stunden einmal um die eigene Achse.", type: "fact" },
                        { text: "Der Weltraum ist faszinierend.", type: "opinion" },
                        { text: "Die Erde umkreist die Sonne in etwa 365 Tagen.", type: "fact" },
                        { text: "Wissenschaftler haben 8 Planeten in unserem Sonnensystem best√§tigt.", type: "fact" },
                        { text: "Pizza ist lecker.", type: "irrelevant" }
                    ],
                    topic: "Weltraum"
                }
            ],
            8: [
                {
                    sentences: [
                        { text: "Laut einer Studie der Universit√§t Hamburg (2023) nutzen 95% der Jugendlichen t√§glich soziale Medien.", type: "fact" },
                        { text: "Soziale Medien sind schlecht f√ºr die Gesellschaft.", type: "opinion" },
                        { text: "Instagram wurde 2010 gegr√ºndet und hat heute √ºber 2 Milliarden Nutzer.", type: "fact" },
                        { text: "Der durchschnittliche Nutzer verbringt 2,5 Stunden t√§glich auf sozialen Plattformen.", type: "fact" },
                        { text: "Experten warnen vor m√∂glichen psychischen Folgen exzessiver Nutzung.", type: "fact" },
                        { text: "Computerspiele sind besser als soziale Medien.", type: "opinion" },
                        { text: "Viele Influencer verdienen ihr Geld mit Werbung.", type: "fact" },
                        { text: "Die Geschichte der Pyramiden ist interessant.", type: "irrelevant" }
                    ],
                    topic: "Soziale Medien"
                }
            ]
        };

        const satzChirurgieData = {
            6: [
                {
                    context: "Hunde sind beliebte Haustiere.",
                    options: [
                        { text: "Sie sind oft treu und freundlich.", correct: true, explanation: "Dieser Satz beschreibt Eigenschaften von Hunden und passt zum Thema." },
                        { text: "Ich mag Schokolade.", correct: false, explanation: "Dieser Satz hat nichts mit Hunden zu tun." },
                        { text: "Die Sonne scheint.", correct: false, explanation: "Dieser Satz passt nicht zum Thema Hunde." }
                    ]
                },
                {
                    context: "Im Winter wird es kalt.",
                    options: [
                        { text: "Im Sommer fahre ich gerne Rad.", correct: false, explanation: "Das Thema ist Winter, nicht Sommer." },
                        { text: "Viele Menschen tragen dann warme Kleidung.", correct: true, explanation: "Dieser Satz beschreibt eine logische Folge der K√§lte im Winter." },
                        { text: "Pizza schmeckt gut.", correct: false, explanation: "Dieser Satz hat nichts mit Winter zu tun." }
                    ]
                }
            ],
            7: [
                {
                    context: "Plastik verschmutzt die Ozeane.",
                    options: [
                        { text: "Deshalb sollten wir weniger Plastik verwenden.", correct: true, explanation: "Kausaler Konnektor 'deshalb' zeigt die logische Folge. Passt perfekt!" },
                        { text: "Au√üerdem schmeckt Eis sehr gut.", correct: false, explanation: "Keine thematische Verbindung zum vorherigen Satz." },
                        { text: "Gestern war Montag.", correct: false, explanation: "Keine inhaltliche Verbindung zum Thema Plastikverschmutzung." }
                    ]
                },
                {
                    context: "Viele Jugendliche treiben Sport, weil sie fit bleiben m√∂chten.",
                    options: [
                        { text: "Aber ich mag keine Hausaufgaben.", correct: false, explanation: "Thema wechselt zu Hausaufgaben ‚Äì keine Koh√§renz." },
                        { text: "Dadurch verbessern sie ihre Gesundheit und ihr Wohlbefinden.", correct: true, explanation: "Perfekt! 'Dadurch' zeigt die Folge und bleibt beim Thema Sport." },
                        { text: "Computer sind teuer.", correct: false, explanation: "V√∂llig anderes Thema." }
                    ]
                }
            ],
            8: [
                {
                    context: "Erneuerbare Energien werden immer wichtiger, da fossile Brennstoffe begrenzt sind.",
                    options: [
                        { text: "Bevor wir handeln, wird es zu sp√§t sein.", correct: false, explanation: "'Bevor' ist hier logisch falsch ‚Äì die Handlung muss JETZT erfolgen." },
                        { text: "Nachdem die Regierung dies erkannt hat, investiert sie in Solarenergie und Windkraft.", correct: true, explanation: "Perfekt! Temporale Abfolge mit 'nachdem' und thematische Koh√§renz." },
                        { text: "Smartphones sind sehr praktisch.", correct: false, explanation: "Komplett anderes Thema." }
                    ]
                },
                {
                    context: "Die Digitalisierung ver√§ndert die Arbeitswelt grundlegend. Viele Berufe werden automatisiert.",
                    options: [
                        { text: "Folglich m√ºssen sich Arbeitnehmer auf neue Anforderungen einstellen und kontinuierlich weiterbilden.", correct: true, explanation: "Exzellent! Kausale Folge mit 'folglich' und pr√§zise Weiterf√ºhrung des Gedankens." },
                        { text: "Katzen sind beliebte Haustiere.", correct: false, explanation: "V√∂llig anderes Thema." },
                        { text: "Wenn es regnet, werde ich nass.", correct: false, explanation: "Zwar korrekte Syntax, aber thematisch irrelevant." }
                    ]
                }
            ]
        };

        const sachtextStudioData = {
            6: [
                {
                    title: "Steckbrief: Der Igel",
                    pieces: [
                        { text: "Der Igel", type: "√ºberschrift", position: 0 },
                        { text: "Der Igel ist ein kleines S√§ugetier.", type: "einleitung", position: 1 },
                        { text: "Er hat etwa 8000 Stacheln.", type: "information", position: 2 },
                        { text: "Er frisst Insekten und W√ºrmer.", type: "information", position: 3 },
                        { text: "Im Winter h√§lt er Winterschlaf.", type: "information", position: 4 },
                        { text: "So √ºberlebt der Igel die kalte Jahreszeit.", type: "schluss", position: 5 }
                    ]
                }
            ],
            7: [
                {
                    title: "Der Klimawandel",
                    pieces: [
                        { text: "Der Klimawandel ‚Äì Eine globale Herausforderung", type: "√ºberschrift", position: 0 },
                        { text: "Der Klimawandel bezeichnet die langfristige Ver√§nderung des Weltklimas.", type: "einleitung", position: 1 },
                        { text: "Die Durchschnittstemperatur ist in den letzten 100 Jahren um 1,1¬∞C gestiegen, weil der CO2-Aussto√ü zugenommen hat.", type: "information", position: 2 },
                        { text: "Laut dem Weltklimarat (IPCC) m√ºssen die Emissionen bis 2030 halbiert werden.", type: "beleg", position: 3 },
                        { text: "Die Polkappen schmelzen, und der Meeresspiegel steigt.", type: "information", position: 4 },
                        { text: "Deshalb ist schnelles Handeln notwendig, um schwerwiegende Folgen zu vermeiden.", type: "schluss", position: 5 }
                    ]
                }
            ],
            8: [
                {
                    title: "K√ºnstliche Intelligenz im Alltag",
                    pieces: [
                        { text: "K√ºnstliche Intelligenz im Alltag ‚Äì Chancen und Risiken", type: "√ºberschrift", position: 0 },
                        { text: "K√ºnstliche Intelligenz (KI) ist l√§ngst Teil unseres t√§glichen Lebens geworden, auch wenn wir sie oft nicht bewusst wahrnehmen.", type: "einleitung", position: 1 },
                        { text: "Zun√§chst findet sich KI in Sprachassistenten wie Alexa oder Siri, die auf Sprachbefehle reagieren.", type: "information", position: 2 },
                        { text: "Dar√ºber hinaus nutzen Streaming-Dienste Algorithmen, um personalisierte Empfehlungen zu erstellen.", type: "information", position: 3 },
                        { text: "Laut einer Studie des Fraunhofer-Instituts (2024) verwenden bereits 78% der deutschen Haushalte KI-gest√ºtzte Technologien.", type: "beleg", position: 4 },
                        { text: "Allerdings warnen Datensch√ºtzer vor m√∂glichem Missbrauch pers√∂nlicher Daten.", type: "gegenargument", position: 5 },
                        { text: "Schlie√ülich zeigt sich: KI bietet gro√üe Potenziale, erfordert jedoch einen verantwortungsvollen Umgang.", type: "schluss", position: 6 }
                    ]
                }
            ]
        };

        const bausteinGeneratorData = {
            6: [
                {
                    notes: {
                        wer: "Bienen",
                        was: "sammeln Nektar",
                        wo: "auf Blumen",
                        warum: "um Honig zu machen"
                    },
                    wordBank: ["Bienen", "sammeln", "Nektar", "auf", "Blumen", "Sie", "machen", "daraus", "Honig", "und", "dann"],
                    topic: "Bienen"
                }
            ],
            7: [
                {
                    notes: {
                        wer: "Sch√ºler der Klasse 7b",
                        was: "pflanzen B√§ume",
                        wo: "im Stadtpark",
                        wann: "am 15. M√§rz 2024",
                        warum: "f√ºr den Klimaschutz"
                    },
                    wordBank: ["Sch√ºler", "Klasse", "7b", "pflanzen", "B√§ume", "Stadtpark", "weil", "sie", "Klima", "sch√ºtzen", "m√∂chten", "Laut", "Klimaexperten", "wichtig"],
                    topic: "Baumpflanzaktion"
                }
            ],
            8: [
                {
                    notes: {
                        thema: "E-Mobilit√§t in Deutschland",
                        fakten: ["2024: 1,2 Mio. E-Autos zugelassen", "Wachstum: 35% gegen√ºber Vorjahr", "Lades√§ulen: 80.000 √∂ffentliche Stationen"],
                        quelle: "Kraftfahrt-Bundesamt, 2024",
                        bewertung: "Infrastruktur noch ausbauf√§hig"
                    },
                    wordBank: ["E-Mobilit√§t", "zun√§chst", "dar√ºber hinaus", "allerdings", "schlie√ülich", "laut", "Kraftfahrt-Bundesamt", "weil", "nachdem", "folglich"],
                    topic: "E-Mobilit√§t"
                }
            ]
        };

        const konnektorenData = {
            6: [
                {
                    sentence1: "Ich gehe in die Schule.",
                    sentence2: "Ich lerne viel.",
                    options: ["und", "weil", "deshalb"],
                    correct: "und",
                    explanation: "F√ºr Klasse 6 reicht 'und' zur Verkn√ºpfung zweier einfacher S√§tze."
                },
                {
                    sentence1: "Es regnet.",
                    sentence2: "Ich nehme einen Regenschirm mit.",
                    options: ["und", "dann", "aber"],
                    correct: "dann",
                    explanation: "'Dann' zeigt eine zeitliche Abfolge."
                }
            ],
            7: [
                {
                    sentence1: "Viele Menschen treiben Sport.",
                    sentence2: "Sie m√∂chten gesund bleiben.",
                    options: ["und", "weil", "dann"],
                    correct: "weil",
                    explanation: "'Weil' zeigt den Grund (Kausalit√§t)."
                },
                {
                    sentence1: "Die Temperaturen steigen.",
                    sentence2: "Die Gletscher schmelzen.",
                    options: ["deshalb", "und", "aber"],
                    correct: "deshalb",
                    explanation: "'Deshalb' zeigt die Folge."
                }
            ],
            8: [
                {
                    sentence1: "Die Regierung hat neue Gesetze verabschiedet.",
                    sentence2: "Die Umweltbelastung soll reduziert werden.",
                    options: ["nachdem", "damit", "obwohl"],
                    correct: "damit",
                    explanation: "'Damit' zeigt den Zweck (finale Konjunktion)."
                },
                {
                    sentence1: "_____ die Schule das Projekt genehmigt hatte, begannen die Sch√ºler mit der Planung.",
                    sentence2: "",
                    options: ["Nachdem", "Bevor", "W√§hrend"],
                    correct: "Nachdem",
                    explanation: "'Nachdem' zeigt die zeitliche Abfolge in der Vergangenheit."
                }
            ]
        };

        // Faktenj√§ger Exercise
        function startFaktenj√§ger() {
            const data = faktenj√§gerData[currentGrade][Math.floor(Math.random() * faktenj√§gerData[currentGrade].length)];
            let html = `
                <div class="question-box">
                    <h3>üéØ Faktenj√§ger: ${data.topic}</h3>
                    <p class="question-text">Markiere jeden Satz:</p>
                    <ul style="margin-left: 20px; margin-bottom: 20px;">
                        <li><strong style="color: #28a745;">Gr√ºn</strong> = Fakten (objektive Informationen)</li>
                        <li><strong style="color: #ffc107;">Gelb</strong> = Meinungen (subjektive Aussagen)</li>
                        ${currentGrade >= 7 ? '<li><strong style="color: #dc3545;">Rot</strong> = Irrelevant (geh√∂rt nicht zum Thema)</li>' : ''}
                    </ul>
                </div>
            `;

            data.sentences.forEach((sent, idx) => {
                html += `
                    <div class="tag-sentence" id="sentence-${idx}">
                        <div style="margin-bottom: 10px;">${sent.text}</div>
                        <div class="tag-buttons">
                            <button class="tag-btn fact" onclick="tagSentence(${idx}, 'fact')">‚úì Fakt</button>
                            <button class="tag-btn opinion" onclick="tagSentence(${idx}, 'opinion')">üí≠ Meinung</button>
                            ${currentGrade >= 7 ? `<button class="tag-btn irrelevant" onclick="tagSentence(${idx}, 'irrelevant')">‚úó Irrelevant</button>` : ''}
                        </div>
                    </div>
                `;
            });

            html += `<div class="button-group">
                <button class="btn btn-success" onclick="checkFaktenj√§ger()">Antworten pr√ºfen</button>
            </div>`;

            document.getElementById('exerciseContent').innerHTML = html;
            currentExerciseData = data;
        }

        let userTags = {};

        function tagSentence(idx, tag) {
            userTags[idx] = tag;
            const elem = document.getElementById(`sentence-${idx}`);
            elem.className = 'tag-sentence tagged-' + tag;
        }

        function checkFaktenj√§ger() {
            let correct = 0;
            let total = currentExerciseData.sentences.length;

            currentExerciseData.sentences.forEach((sent, idx) => {
                if (userTags[idx] === sent.type) {
                    correct++;
                }
            });

            totalAnswers++;
            if (correct === total) {
                correctAnswers++;
                const points = currentGrade * 10;
                addPoints(points);
                showFeedback('success', `üéâ Perfekt! Alle ${total} S√§tze richtig markiert! +${points} Punkte`);
            } else {
                showFeedback('error', `Du hast ${correct} von ${total} S√§tzen richtig markiert. Versuche es noch einmal!`);
            }

            userTags = {};
            setTimeout(() => {
                if (correct === total) {
                    nextQuestion('faktenj√§ger');
                }
            }, 2000);
        }

        // Satz-Chirurgie Exercise
        function startSatzChirurgie() {
            const questions = satzChirurgieData[currentGrade];
            const q = questions[currentQuestion % questions.length];
            
            let html = `
                <div class="question-box">
                    <h3>üîß Satz-Chirurgie</h3>
                    <p class="question-text"><strong>Gegebener Text:</strong><br>"${q.context}"</p>
                    <p style="margin-top: 15px;"><strong>W√§hle den besten Folgesatz:</strong></p>
                </div>
                <div class="options">
            `;

            q.options.forEach((opt, idx) => {
                html += `<button class="option-btn" onclick="checkSatzChirurgie(${idx})">${opt.text}</button>`;
            });

            html += `</div>`;

            document.getElementById('exerciseContent').innerHTML = html;
            currentExerciseData = q;
        }

        function checkSatzChirurgie(selected) {
            const buttons = document.querySelectorAll('.option-btn');
            const q = currentExerciseData;
            totalAnswers++;

            buttons.forEach((btn, idx) => {
                btn.classList.add('disabled');
                if (q.options[idx].correct) {
                    btn.classList.add('correct');
                }
                if (idx === selected && !q.options[idx].correct) {
                    btn.classList.add('incorrect');
                }
            });

            if (q.options[selected].correct) {
                correctAnswers++;
                const points = currentGrade * 10;
                addPoints(points);
                showFeedback('success', `‚úÖ Richtig! ${q.options[selected].explanation} +${points} Punkte`);
            } else {
                showFeedback('error', `‚ùå Leider falsch. ${q.options[selected].explanation}`);
            }

            setTimeout(() => {
                if (q.options[selected].correct) {
                    nextQuestion('satzChirurgie');
                } else {
                    startSatzChirurgie();
                }
            }, 3000);
        }

        // Sachtext-Studio Exercise
        function startSachtextStudio() {
            const data = sachtextStudioData[currentGrade][0];
            let shuffled = [...data.pieces].sort(() => Math.random() - 0.5);
            
            let html = `
                <div class="question-box">
                    <h3>üé® Sachtext-Studio: ${data.title}</h3>
                    <p class="question-text">Ziehe die Textbausteine in die richtige Reihenfolge, um einen guten Sachtext zu erstellen!</p>
                </div>
                
                <div id="dropZone" class="drop-zone"></div>
                
                <div style="margin-top: 20px;">
                    <h4>Verf√ºgbare Bausteine:</h4>
            `;

            shuffled.forEach((piece, idx) => {
                html += `
                    <div class="draggable" draggable="true" data-position="${piece.position}" id="piece-${idx}">
                        <strong>[${piece.type}]</strong> ${piece.text}
                    </div>
                `;
            });

            html += `</div>
                <div class="button-group">
                    <button class="btn btn-success" onclick="checkSachtextStudio()">Anordnung pr√ºfen</button>
                    <button class="btn btn-secondary" onclick="startSachtextStudio()">Neu mischen</button>
                </div>
            `;

            document.getElementById('exerciseContent').innerHTML = html;
            currentExerciseData = data;

            // Add drag and drop functionality
            setTimeout(initDragAndDrop, 100);
        }

        function initDragAndDrop() {
            const draggables = document.querySelectorAll('.draggable');
            const dropZone = document.getElementById('dropZone');

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', () => {
                    draggable.classList.add('dragging');
                });

                draggable.addEventListener('dragend', () => {
                    draggable.classList.remove('dragging');
                });
            });

            dropZone.addEventListener('dragover', e => {
                e.preventDefault();
                dropZone.classList.add('drag-over');
            });

            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('drag-over');
            });

            dropZone.addEventListener('drop', e => {
                e.preventDefault();
                dropZone.classList.remove('drag-over');
                const dragging = document.querySelector('.dragging');
                if (dragging) {
                    dropZone.appendChild(dragging);
                }
            });
        }

        function checkSachtextStudio() {
            const dropZone = document.getElementById('dropZone');
            const pieces = dropZone.querySelectorAll('.draggable');
            
            let correct = true;
            pieces.forEach((piece, idx) => {
                const expectedPosition = parseInt(piece.dataset.position);
                if (expectedPosition !== idx) {
                    correct = false;
                }
            });

            totalAnswers++;
            if (correct) {
                correctAnswers++;
                const points = currentGrade * 15;
                addPoints(points);
                showFeedback('success', `üéâ Perfekt! Der Text ist richtig aufgebaut! +${points} Punkte`);
                setTimeout(() => {
                    exercisesCompleted++;
                    updateStats();
                    showCompletionScreen();
                }, 2000);
            } else {
                showFeedback('error', '‚ùå Die Reihenfolge ist noch nicht ganz richtig. √úberlege: √úberschrift ‚Üí Einleitung ‚Üí Informationen ‚Üí Schluss');
            }
        }

        // Baustein-Generator Exercise
        function startBausteinGenerator() {
            const data = bausteinGeneratorData[currentGrade][0];
            
            let html = `
                <div class="question-box">
                    <h3>üìù Baustein-Generator: ${data.topic}</h3>
                    <p class="question-text">Verwandle diese Notizen in einen zusammenh√§ngenden Sachtext-Absatz!</p>
                    
                    <div style="background: #fff3cd; padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <h4>Notizen:</h4>
            `;

            if (currentGrade === 6) {
                html += `
                    <p><strong>Wer:</strong> ${data.notes.wer}</p>
                    <p><strong>Was:</strong> ${data.notes.was}</p>
                    <p><strong>Wo:</strong> ${data.notes.wo}</p>
                    <p><strong>Warum:</strong> ${data.notes.warum}</p>
                `;
            } else if (currentGrade === 7) {
                html += `
                    <p><strong>Wer:</strong> ${data.notes.wer}</p>
                    <p><strong>Was:</strong> ${data.notes.was}</p>
                    <p><strong>Wo:</strong> ${data.notes.wo}</p>
                    <p><strong>Wann:</strong> ${data.notes.wann}</p>
                    <p><strong>Warum:</strong> ${data.notes.warum}</p>
                `;
            } else {
                html += `
                    <p><strong>Thema:</strong> ${data.notes.thema}</p>
                    <p><strong>Fakten:</strong></p>
                    <ul>`;
                data.notes.fakten.forEach(f => {
                    html += `<li>${f}</li>`;
                });
                html += `</ul>
                    <p><strong>Quelle:</strong> ${data.notes.quelle}</p>
                    <p><strong>Bewertung:</strong> ${data.notes.bewertung}</p>
                `;
            }

            html += `
                    </div>
                    
                    <h4>Wortbank (klicke auf W√∂rter, um sie zu verwenden):</h4>
                    <div class="word-bank" id="wordBank">
            `;

            data.wordBank.forEach((word, idx) => {
                html += `<span class="word-chip" onclick="addWord('${word}', ${idx})">${word}</span>`;
            });

            html += `
                    </div>
                    
                    <p style="margin-top: 20px;"><strong>Dein Text:</strong></p>
                    <textarea class="text-input" id="userText" placeholder="Schreibe hier deinen Sachtext-Absatz..."></textarea>
                    
                    ${currentGrade >= 7 ? '<p style="color: #666; font-size: 0.9em;">üí° Tipp: Verwende mindestens einen kausalen Konnektor (weil, deshalb, daher)!</p>' : ''}
                    ${currentGrade >= 8 ? '<p style="color: #666; font-size: 0.9em;">üí° Tipp: F√ºge Einleitungssatz, Fakten mit Quelle und Schlusssatz hinzu!</p>' : ''}
                </div>
                
                <div class="button-group">
                    <button class="btn btn-success" onclick="checkBausteinGenerator()">Text pr√ºfen</button>
                    <button class="btn btn-secondary" onclick="clearText()">Text l√∂schen</button>
                </div>
            `;

            document.getElementById('exerciseContent').innerHTML = html;
            currentExerciseData = data;
        }

        function addWord(word, idx) {
            const chip = document.querySelectorAll('.word-chip')[idx];
            if (!chip.classList.contains('used')) {
                const textarea = document.getElementById('userText');
                textarea.value += (textarea.value ? ' ' : '') + word;
                chip.classList.add('used');
            }
        }

        function clearText() {
            document.getElementById('userText').value = '';
            document.querySelectorAll('.word-chip').forEach(chip => {
                chip.classList.remove('used');
            });
        }

        function checkBausteinGenerator() {
            const text = document.getElementById('userText').value.trim();
            
            if (text.length < 50) {
                showFeedback('error', '‚ùå Dein Text ist zu kurz! Schreibe mindestens 3-4 zusammenh√§ngende S√§tze.');
                return;
            }

            let score = 0;
            let feedback = [];

            // Check for connectors based on grade
            if (currentGrade >= 7) {
                const connectors = ['weil', 'deshalb', 'daher', 'denn', 'da'];
                const hasConnector = connectors.some(c => text.toLowerCase().includes(c));
                if (hasConnector) {
                    score += 5;
                    feedback.push('‚úì Kausaler Konnektor verwendet');
                }
            }

            if (currentGrade >= 8) {
                const temporalConnectors = ['zun√§chst', 'dar√ºber hinaus', 'schlie√ülich', 'nachdem'];
                const hasTemp = temporalConnectors.some(c => text.toLowerCase().includes(c));
                if (hasTemp) {
                    score += 5;
                    feedback.push('‚úì Temporale Gliederung');
                }
            }

            // Basic content check
            if (text.split(' ').length >= 30) {
                score += 5;
                feedback.push('‚úì Ausf√ºhrliche Beschreibung');
            }

            totalAnswers++;
            if (score >= 5) {
                correctAnswers++;
                const points = currentGrade * 10;
                addPoints(points);
                showFeedback('success', `üéâ Gut gemacht! ${feedback.join(', ')}. +${points} Punkte`);
                setTimeout(() => {
                    exercisesCompleted++;
                    updateStats();
                    showCompletionScreen();
                }, 2500);
            } else {
                showFeedback('error', `‚ö†Ô∏è Dein Text braucht noch mehr Struktur. ${feedback.length > 0 ? feedback.join(', ') : 'F√ºge passende Konnektoren und mehr Details hinzu!'}`);
            }
        }

        // Konnektoren Training Exercise
        function startKonnektorenTraining() {
            const questions = konnektorenData[currentGrade];
            const q = questions[currentQuestion % questions.length];
            
            let html = `
                <div class="question-box">
                    <h3>üîó Konnektoren-Training</h3>
                    <p class="question-text">Verbinde die S√§tze mit dem passenden Bindewort!</p>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <p style="font-size: 1.1em; margin-bottom: 10px;">${q.sentence1}</p>
                        <p style="font-size: 1.5em; text-align: center; color: #667eea; margin: 15px 0;">
                            <strong>[ ? ]</strong>
                        </p>
                        ${q.sentence2 ? `<p style="font-size: 1.1em;">${q.sentence2}</p>` : ''}
                    </div>
                    
                    <p><strong>W√§hle den passenden Konnektor:</strong></p>
                </div>
                
                <div class="options">
            `;

            q.options.forEach((opt, idx) => {
                html += `<button class="option-btn" onclick="checkKonnektor(${idx})">${opt}</button>`;
            });

            html += `</div>`;

            document.getElementById('exerciseContent').innerHTML = html;
            currentExerciseData = q;
        }

        function checkKonnektor(selected) {
            const buttons = document.querySelectorAll('.option-btn');
            const q = currentExerciseData;
            const isCorrect = q.options[selected] === q.correct;
            
            totalAnswers++;

            buttons.forEach((btn, idx) => {
                btn.classList.add('disabled');
                if (q.options[idx] === q.correct) {
                    btn.classList.add('correct');
                }
                if (idx === selected && !isCorrect) {
                    btn.classList.add('incorrect');
                }
            });

            if (isCorrect) {
                correctAnswers++;
                const points = currentGrade * 10;
                addPoints(points);
                showFeedback('success', `‚úÖ Richtig! ${q.explanation} +${points} Punkte`);
            } else {
                showFeedback('error', `‚ùå Leider falsch. ${q.explanation}`);
            }

            setTimeout(() => {
                if (isCorrect) {
                    nextQuestion('konnektorenTraining');
                } else {
                    startKonnektorenTraining();
                }
            }, 3000);
        }

        // Exercise Management
        function startExercise(type) {
            currentExercise = type;
            currentQuestion = 0;
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('exerciseArea').classList.remove('hidden');
            
            const titles = {
                'faktenj√§ger': 'üéØ Faktenj√§ger',
                'satzChirurgie': 'üîß Satz-Chirurgie',
                'sachtextStudio': 'üé® Sachtext-Studio',
                'bausteinGenerator': 'üìù Baustein-Generator',
                'konnektorenTraining': 'üîó Konnektoren-Training'
            };
            
            document.getElementById('exerciseTitle').textContent = titles[type];
            updateProgressBar();
            
            switch(type) {
                case 'faktenj√§ger': startFaktenj√§ger(); break;
                case 'satzChirurgie': startSatzChirurgie(); break;
                case 'sachtextStudio': startSachtextStudio(); break;
                case 'bausteinGenerator': startBausteinGenerator(); break;
                case 'konnektorenTraining': startKonnektorenTraining(); break;
            }
        }

        function nextQuestion(type) {
            currentQuestion++;
            updateProgressBar();
            
            switch(type) {
                case 'faktenj√§ger': startFaktenj√§ger(); break;
                case 'satzChirurgie': startSatzChirurgie(); break;
                case 'konnektorenTraining': startKonnektorenTraining(); break;
            }
        }

        function updateProgressBar() {
            const progress = Math.min((currentQuestion / 5) * 100, 100);
            const bar = document.getElementById('progressBar');
            bar.style.width = progress + '%';
            bar.textContent = Math.round(progress) + '%';
        }

        function showFeedback(type, message) {
            const existing = document.querySelector('.feedback');
            if (existing) existing.remove();
            
            const feedback = document.createElement('div');
            feedback.className = `feedback ${type}`;
            feedback.textContent = message;
            
            document.getElementById('exerciseContent').insertBefore(
                feedback,
                document.getElementById('exerciseContent').firstChild
            );
            
            feedback.classList.add('pulse');
        }

        function showCompletionScreen() {
            const stars = correctAnswers >= totalAnswers * 0.9 ? '‚≠ê‚≠ê‚≠ê' : 
                         correctAnswers >= totalAnswers * 0.7 ? '‚≠ê‚≠ê' : '‚≠ê';
            
            const html = `
                <div class="completion-screen">
                    <h2>üéâ √úbung abgeschlossen!</h2>
                    <div class="star-rating">${stars}</div>
                    <div class="score">${totalPoints} Punkte</div>
                    <p style="font-size: 1.2em; margin: 20px 0;">
                        Du hast ${correctAnswers} von ${totalAnswers} Aufgaben richtig gel√∂st!
                    </p>
                    <div class="button-group" style="justify-content: center;">
                        <button class="btn btn-primary" onclick="backToMenu()">Zur√ºck zum Men√º</button>
                        <button class="btn btn-success" onclick="startExercise('${currentExercise}')">Noch einmal</button>
                    </div>
                </div>
            `;
            
            document.getElementById('exerciseContent').innerHTML = html;
        }
    </script>
</body>
</html>